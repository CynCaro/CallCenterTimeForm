<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@200..800&display=swap" rel="stylesheet">
    <!-- CSS -->
    <link rel="stylesheet" href="./css/styles.css">
    <title>Call Center Time Form</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.15.0/xlsx.full.min.js"></script>
</head>

<body>
    <main>
        <section>
            <img src="img/AP-manager-interfaz.png" alt="background AP Manager" class="background-image">
            <section class="form">
                <header>
                    <nav>
                        <ul>
                            <li>Captura actividad</li>
                            <li>Histórico actividades</li>
                            <li>WhatsApp</li>
                            <li>Preferencias del interesado</li>
                            <li>Correos electrónicos</li>
                            <li>Histórico de cambios</li>
                            <li>Asignaciones</li>
                            <li>Suceso Histórico</li>
                            <li>Consulta Original</li>
                        </ul>
                    </nav>
                </header>
                <p>Registro de nueva actividad</p>

                <hr>

                <form>
                    <div class="form-row">
                        <!-- Canal de comunicación -->
                        <div class="form-group-column">
                            <label for="canaldecomunicacion">Canal de comunicación *</label>
                            <div class="custom-select">
                                <select id="canaldecomunicacion" name="canaldecomunicacion" required>
                                    <option value="" disabled selected>Selecciona</option> <!-- Opción por defecto -->
                                    <option value="in_call">1- Correo entrante</option>
                                    <option value="out_call">2- Correo saliente</option>
                                    <option value="in_wa_g">3- Llamada entrante</option>
                                    <option value="in_wa_p">4- Llamada saliente</option>
                                    <option value="out_wa_g">5- Wa G entrante</option>
                                    <option value="out_wa_p">6- Wa G saliente</option>
                                    <option value="in_mail">7- Wa P entrante</option>
                                    <option value="out_mail">8- Wa P saliente</option>
                                </select>
                            </div>
                        </div>

                        <!-- Resultado 1 -->
                        <div class="form-group-column">
                            <label for="resultado1">1) Estatus de contacto *</label>
                            <div class="custom-select">
                                <select id="resultado1" name="resultado1">
                                    <option value="" disabled selected>Selecciona</option> <!-- Opción por defecto -->
                                    <option value="contactado">Contactado</option>
                                    <option value="no_contactado">No contactado</option>
                                </select>
                            </div>
                        </div>

                        <!-- Tipo de contacto -->
                        <div class="form-group-column" style="display: none;">
                            <label for="tipocontacto">2) Resultado del contacto *</label>
                            <div class="custom-select">
                                <select id="tipocontacto" name="tipocontacto">
                                    <option value="" disabled selected>Selecciona</option> <!-- Opción por defecto -->
                                    <option value="primer_contacto">Primer contacto</option>
                                    <option value="seguimiento">Seguimiento</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="form-row">
                        <!-- Resultado 2 -->
                        <div class="form-group-column" id="resultado2-container" style="display: none;">
                            <label for="resultado2">3) Respuesta de lead *</label>
                            <div class="custom-select">
                                <select id="resultado2" name="resultado2">
                                    <option value="" disabled selected>Seleciona</option> <!-- Opción por defecto -->
                                    <option value="aplico_en_universidad">Aplicó en Universidad</option>
                                    <option value="interesado">Interesado</option>
                                    <option value="no_interesado">No interesado</option>
                                    <option value="no_efectivo">No efectivo</option>
                                    <option value="no_contesta">No contesta</option>
                                </select>
                            </div>
                        </div>

                        <!-- Tificicación - N1 -->
                        <div class="form-group-column" id="tipificacionn1-container" style="display: none;">
                            <label for="tipificacionn1">4) Tipificación de respuesta *</label>
                            <div class="custom-select">
                                <select id="tipificacionn1" name="tipificacionn1">
                                    <option value="" disabled selected>Selecciona</option> <!-- Opción por defecto -->
                                </select>
                            </div>
                        </div>

                        <!-- Popup de Solo buscaba información -->
                        <div id="informacion-popup" style="display: none;">
                            <label for="informacion-requerida">Solo buscaba información</label>
                            <p>Selecciona el motivo:</p>
                            <div>
                                <input type="checkbox" id="becas" value="Becas"> Becas<br>
                                <input type="checkbox" id="modalidad" value="Busca otra modalidad"> Busca otra
                                modalidad<br>
                                <input type="checkbox" id="contenido_programa" value="Contenido del programa">
                                Contenido del programa<br>
                                <input type="checkbox" id="costos" value="Costos"> Costos<br>
                                <input type="checkbox" id="otra_persona" value="El programa es para otra persona"> El programa es para otra persona<br>
                                <input type="checkbox" id="fechas_inicio" value="Fechas de inicio"> Fechas de
                                inicio<br>
                                <input type="checkbox" id="no_motivo" value="No da motivo"> No da motivo<br>
                            </div>
                            <button id="guardar-informacion">Aceptar</button>
                        </div>

                        <!-- Contenedor de la selección -->
                        <div id="informacion-container" class="form-group-column" style="display: none;">
                            <label for="informacion-seleccionada">Motivo seleccionado:</label>
                            <div>
                                <ul id="informacion-seleccionados"></ul>
                                <button id="editar-informacion">Editar</button>
                            </div>
                        </div>


                        <!-- Tipificación - N2 -->
                        <div class="form-group-column" id="tipificacionn2-container" style="display: none;">
                            <label for="tipificacionn2">5) Subtipificación de respuesta *</label>
                            <div class="custom-select">
                                <select id="tipificacionn2" name="tipificacionn2" required>
                                    <option value="" disabled selected>Selecciona</option> <!-- Opción por defecto -->
                                    <!-- Aquí se llenarán las opciones dinámicamente -->
                                </select>
                            </div>
                        </div>

                    </div>

                    <div class="form-row">
                        <!-- Tipificación - N3 -->
                        <div class="form-group-column" id="tipificacionn3-container" style="display: none;">
                            <label for="tipificacionn3" id="tipificacionn3-label">Detalles de subtipificación *</label>
                            <div class="custom-select">
                                <select id="tipificacionn3" name="tipificacionn3" required>
                                    <option value="" disabled selected>Selecciona</option> <!-- Opción por defecto -->
                                </select>
                            </div>
                        </div>

                        <!-- Popup de Documentos -->
                        <div id="documentos-popup" style="display: none;">
                            <label for="documentosrequeridos">Documentos faltantes</label>
                            <p>Selecciona los documentos que el aspirante NO tiene:</p>
                            <div>
                                <input type="checkbox" id="acta_nacimiento" value="Acta de nacimiento">Acta de
                                nacimiento<br>
                                <input type="checkbox" id="cedula_profesional" value="Cédula profesional">Cédula
                                profesional<br>
                                <input type="checkbox" id="certificado_licenciatura"
                                    value="Certificado de licenciatura">Certificado de licenciatura<br>
                                <input type="checkbox" id="curp" value="Curp"> CURP<br>
                                <input type="checkbox" id="titulo" value="Título"> Título<br>
                                <div><input type="checkbox" id="titulacion_maestria"
                                        value="Títulación por maestría"> Titulación por maestría<br></div>
                            </div>
                            <button id="guardar-documentos">Guardar</button>
                        </div>

                        <!-- Documentos faltantes -->
                        <div id="documentos-container" class="form-group-column" style="display: none;">
                            <label for="documentosfaltantes">Documentos faltantes:</label>
                            <div>
                                <ul id="documentos-seleccionados"></ul>
                                <button id="editar-documentos">Editar</button>
                            </div>
                        </div>

                        <!-- Popup de Seguimiento -->
                        <div id="seguimiento-popup" style="display: none;">
                            <label for="seguimiento">Método de seguimiento</label>
                            <p>Selecciona el método utilizado:</p>
                            <div>
                                <input type="checkbox" id="correo" name="metodo_seguimiento" value="Correo">
                                <label for="correo">Correo</label><br>

                                <input type="checkbox" id="llamada" name="metodo_seguimiento" value="Llamada">
                                <label for="llamada">Llamada</label><br>

                                <input type="checkbox" id="no_especifica" name="metodo_seguimiento"
                                    value="No especifica">
                                <label for="no_especifica">No especifica</label><br>

                                <input type="checkbox" id="whatsapp" name="metodo_seguimiento" value="WhatsApp">
                                <label for="whatsapp">WhatsApp</label><br>
                            </div>
                            <button id="guardar-seguimiento">Aceptar</button>
                        </div>
                        <!-- Método de Seguimiento -->
                        <div id="seguimiento-container" class="form-group-column" style="display: none;">
                            <label for="metodo">Método de seguimiento:</label>
                            <div>
                                <ul id="metodo-seleccionado"></ul>
                                <button id="editar-seguimiento">Editar</button>
                            </div>
                        </div>

                        <!-- Popup de comparación de universidades -->
                        <div id="comparacion-universidades-popup" style="display: none;">
                            <label for="otras_universidades">Universidades:</label>
                            <div id="comparacion-universidades"></div>
                            <!-- Aquí se inyectarán los checkboxes dinámicos -->
                            <button id="guardar-comparacion" type="button">Guardar</button>
                        </div>

                        <!-- Contenedor de comparación de universidades -->
                        <div id="comparacion-universidades-container" class="form-group-column" style="display: none;">
                            <label for="comparacion">Seleccionadas:</label>
                            <ul id="universidades-seleccionadas"></ul>
                            <button id="editar-comparacion" type="button">Editar</button>
                        </div>

                        <!-- Resultado 4 -->
                        <div class="form-group-column" id="statusfinal-container" style="display: none;">
                            <label for="statusfinal"></label>
                            <div>
                                <input type="text" id="statusfinal" name="statusfinal" required readonly>
                                <!-- Campo readonly para no permitir edición -->
                            </div>
                        </div>

                        <!-- Tipificación - N4 -->
                        <div class="form-group-column" id="tipificacionn4-container" style="display: none;">
                            <label for="tipificacionn4" id="tipificacionn4-label">7) Tipo de enseñanza *</label>
                            <div class="custom-select">
                                <select id="tipificacionn4" name="tipificacionn4" required>
                                    <option value="" disabled selected>Selecciona</option>
                                </select>
                            </div>
                        </div>

                        <!-- Popup de Documentos sin apostillar -->
                        <div id="documentos-sin-apostillar-popup" style="display: none;">
                            <label for="documentos_sin_apostillar">Documentos sin apostillar</label>
                            <p>Selecciona los documentos:</p>
                            <div>
                                <input type="checkbox" id="acta_nacimiento_apostilla"
                                    value="Acta de nacimiento">Acta de nacimiento<br>
                                <input type="checkbox" id="record_notas" value="Récord de notas">Récord de notas /
                                Certificado total de estudios<br>
                                <input type="checkbox" id="titulo_apostilla" value="Título">Título<br>
                            </div>
                            <button id="guardar-documentos-sin-apostillar">Guardar</button>
                        </div>

                        <!-- Contenedor de los Documentos sin apostillar seleccionados -->
                        <div id="documentos-sin-apostillar-container" class="form-group-column" style="display: none;">
                            <label for="documentos_seleccionados_sin_apostillar">Documentos sin apostillar:</label>
                            <div>
                                <ul id="documentos-seleccionados-sin-apostillar"></ul>
                                <button id="editar-documentos-sin-apostillar">Editar</button>
                            </div>
                        </div>

                        <!-- Popup de Documentos Sin Documento -->
                        <div id="documentos-sin-documento-popup" style="display: none;">
                            <label for="documentos_sin_documento">Sin documento</label>
                            <p>Selecciona los documentos faltantes:</p>
                            <div>
                                <input type="checkbox" id="acta_nacimiento" value="Acta de nacimiento">Acta de
                                nacimiento<br>
                                <input type="checkbox" id="curp" value="CURP">CURP<br>
                                <input type="checkbox" id="dictamen_revalidacion"
                                    value="Dictamen de Revalidación">Dictamen de Revalidación<br>
                                <input type="checkbox" id="forma_migratoria" value="Forma migratoria">Forma
                                migratoria<br>
                                <input type="checkbox" id="record_notas" value="Récord de notas">Récord de
                                notas<br>
                                <input type="checkbox" id="titulo" value="Título">Título<br>


                            </div>
                            <button id="guardar-documentos-sin-documento">Guardar</button>
                        </div>

                        <!-- Contenedor de los Documentos Sin Documento seleccionados -->
                        <div id="documentos-sin-documento-container" class="form-group-column" style="display: none;">
                            <label for="documentos_seleccionados_sin_documento">Sin Documento:</label>
                            <div>
                                <ul id="documentos-seleccionados-sin-documento"></ul>
                                <button id="editar-documentos-sin-documento">Editar</button>
                            </div>
                        </div>

                    </div>

                    <div class="form-row">
                        <!-- Interés -->
                        <div class="form-group-column">
                            <label for="tipificacionn1">Interés del lead *</label>
                            <div class="custom-select">
                                <select id="interes" name="interes">
                                    <option value="" disabled selected>Selecciona</option>
                                    <!-- Opción por defecto -->
                                    <option value="alto">Alto</option>
                                    <option value="medio">Medio</option>
                                    <option value="bajo">Bajo</option>
                                    <option value="na">N/A</option>
                                </select>
                            </div>
                        </div>

                        <!-- Estado Final
                        <div class="form-group-column">
                            <label for="estadofinal">Estado Final *</label>
                            <div>
                                <input type="text" id="estadofinal" name="estadofinal" required>
                                </select>
                            </div>
                        </div> -->

                        <!-- Próxima actividad -->
                        <div class="form-group-column">
                            <label for="proximaactividad">Próxima comunicación *</label>
                            <div class="custom-select">
                                <select id="proximaactividad" name="proximaactividad" required>
                                    <option value="" disabled selected>Selecciona</option>
                                    <!-- Opción por defecto -->
                                    <option value="out_call">1- Envío de correo</option>
                                    <option value="out_wa_p">2- Llamada saliente</option>
                                    <option value="out_wa_g">3- Wa G saliente</option>
                                    <option value="out_mail">4- Wa P saliente</option>
                                </select>
                            </div>
                        </div>

                        <!-- Fecha próxima actividad -->
                        <div class="form-group-column">
                            <label for="fechaproxact">Fecha próxima comunicación *</label>
                            <div class="custom-date">
                                <input type="date" id="fechaproxact" name="fechaproxact">
                            </div>
                        </div>
                    </div>

                    <div class="form-row">
                        <!-- Hora próxima actividad -->
                        <div class="form-group-column">
                            <label for="horaproxact">Horario próxima comunicación *</label>
                            <div class="custom-time">
                                <input type="time" id="horaproxact" name="horaproxact">
                            </div>
                        </div>
                    </div>

                    <div class="form-row-final">
                        <!-- Descripción -->
                        <div class="descripcion-column">
                            <label for="proximaactividad">Descripción de comunicación *</label>
                            <div class="description-text">
                                <textarea id="descripcion" name="descripcion" required></textarea>
                                <!-- Status Final -->
                                <div class="status-last-section">
                                    <label for="statuslast">Status Final *</label>
                                    <div>
                                        <input type="text" id="statuslast" name="statuslast" required readonly>
                                        </select>
                                    </div>
                                    <!-- Botón para exportar a Excel -->
                                    <button id="exportarExcelButton" type="button">Exportar a Excel</button>
                                </div>
                            </div>
                        </div>

                        <!-- Botones -->
                        <div class="button-group">
                            <button type="button">Nuevo WhatsApp</button>
                            <button type="button">Correo automático</button>
                            <button type="button">Nuevo email</button>
                            <button type="button">Nuevo ticket</button>
                            <div class="button-send">
                                <button type="button">Cancelar</button>
                                <button type="button" id="guardarButton" disabled>Guardar</button>
                            </div>
                        </div>
                    </div>


                    </div>
                </form>

            </section>
        </section>
    </main>
    <script src="index.js"></script>
</body>

</html>